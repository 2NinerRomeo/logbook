{use_macro file="Dataface_Main_Template.html"}
  {fill_slot name="main_section"}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js" ></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.stack.js"></script>
<script type="text/javascript">
{literal}
$(function () {
   //First, Total Hours Data
   var totalHours = {/literal}{$totalHours}{literal};
   var surpTotalHours = 0;
   var defTotalHours = 0;
   var reqTotalHours = 250;
   if (totalHours > reqTotalHours){
      surpTotalHours = totalHours-reqTotalHours;
      defTotalHours = 0;
      totalHours = reqTotalHours;
   }else{
      surpTotalHours = 0;
      defTotalHours = reqTotalHours-totalHours;
   }

   //Now a PIC Data
   var picHours = {/literal}{$picHours}{literal};
   var surpPicHours = 0;
   var defPicHours = 0;
   var reqPicHours = 100;
   if (picHours > reqPicHours){
      surpPicHours = picHours-reqPicHours;
      defPicHours = 0;
      picHours = reqPicHours;
   }else{
      surpPicHours = 0;
      defPicHours = reqPicHours-picHours;
   }

   //now combine them into one chart
   var combinedHoursBarData = [{
      data : [
         [ totalHours , 0 ],
         [ picHours , -1 ]
      ],
      label: "required complete"
   }, {
      data: [
         [ surpTotalHours , 0 ],
         [ surpPicHours , -1 ]
      ],
      label: "surplus"
   }, {
      data: [
         [ defTotalHours , 0 ],
         [ defPicHours , -1 ]
      ],
      label: "deficient"
   }];

//   var ticks = [[0,"PIC"],
//                [1,"Total"]];
   var ticks = [[0,"Total"],
                [-1,"PIC"]];

   $.plot($("#combinedChart"),
          combinedHoursBarData,
          {
           series: {
             stack: true,
             bars: {show:true,
                    horizontal:true,
                    barWidth: 0.6,
                    align: "center"
             }
           },
           yaxis: {show: true,
                   axisLabel: "Pic Time",
                   axisLabelUseCanvas: true,
                   ticks: ticks
           }
          });
});
</script>
{/literal}

{$body}

  {/fill_slot}
{/use_macro}  
